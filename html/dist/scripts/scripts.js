"use strict";var userApp=angular.module("userApp",["ngRoute","ngResource","highcharts-ng","ui.bootstrap"]);userApp.config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"mainController"}).when("/:key/",{templateUrl:"views/function.html",controller:"functionController"}).otherwise({redirectTo:"/"})}]).constant("API_URL","http://127.0.0.1:3000/api");var userApp=angular.module("userApp");userApp.factory("executionFactory",["$rootScope","$http","$q","API_URL",function(a,b,c,d){return{getTotal:function(a,e,f){var g=c.defer(),h="";return f>=0&&e>=0&&(h="/"+e+"/"+f),b.get(d+"/total/"+a+h).success(function(a){g.resolve(a)}).error(function(){g.reject()}),g.promise},getCurrentKeyWithRange:function(a,e,f,g){var h=c.defer();return b.get(d+"/key/"+a+"/execution_time/"+f+"/"+g+"/page/"+e).success(function(a,b,c,d){h.resolve(a,b,c,d)}).error(function(){h.reject()}),h.promise},getCurrentKey:function(a,e){var f=c.defer();return b.get(d+"/key/"+a+"/execution_time/page/"+e).success(function(a,b){f.resolve(a)}).error(function(){f.reject()}),f.promise}}}]);var userApp=angular.module("userApp");userApp.directive("dateTime",function(){return{restrict:"A",require:"?ngModel",link:function(a,b,c,d){function e(){d.$setViewValue(b.val())}return d?(b.bind("blur keyup change",function(){a.$apply(e)}),void e()):void console.log("no model, returning")}}});var userApp=angular.module("userApp");userApp.controller("functionController",["$routeParams","$rootScope","$scope","$location","$http","$filter","$interval","executionFactory",function(a,b,c,d,e,f,g,h){c.currentKey=a.key,c.currentDate=new Date,c.startTime=f("date")(c.currentDate,"HH:mm"),c.endTime=f("date")(c.currentDate,"HH:mm"),c.startDate=f("date")(c.currentDate,"yyyy-MM-dd"),c.endDate=f("date")(c.currentDate,"yyyy-MM-dd"),c.executionTimes=[],c.getTotalForKey=0,c.totalItems=0,c.chartSeries=[],c.isTimerDisabled=!1,c.updateNumber=1e4;var i=!0;c.submitTimeRange=function(a,b,d,e,f){i=!1,c.isTimerDisabled=!0,c.timerCheck=!1;var g=new Date(a+"T"+b+":59Z").getTime()/1e3,j=new Date(d+"T"+e+":59Z").getTime()/1e3;c.listForChart=[],h.getCurrentKeyWithRange(c.currentKey,f,g,j).then(function(a){c.executionTimes=a,c.getTotal(g,j),a.forEach(function(a){c.listForChart.push(a.execution_time)})}),c.chartSeries=[{name:"Execution Time",data:c.listForChart,color:"#6956D6"}],c.drawChart(c.chartSeries)},c.drawChart=function(a){c.chartConfig={options:{chart:{type:"spline",animation:Highcharts.svg,marginRight:25},plotOptions:{series:{stacking:""}}},chart:{renderTo:"container"},series:a,title:{text:"Execution Times"},xAxis:{reversed:!0},credits:{enabled:!1},loading:!1,size:{}}},c.getCurrentKey=function(a){c.listForChart=[],c.getTotal(-1,-1),h.getCurrentKey(c.currentKey,a).then(function(a){c.executionTimes=a,a.forEach(function(a){c.listForChart.push(a.execution_time)})}),c.chartSeries=[{name:"Execution Time",data:c.listForChart,color:"#6956D6"}]},c.GetAllEx=function(){c.getCurrentKey(0),c.drawChart(c.chartSeries),c.setPage(1),i=!0,c.isTimerDisabled=!1,c.timerCheck=!1},c.getTotal=function(a,b){var d=h.getTotal(c.currentKey,a,b);d.then(function(a){c.getTotalForKey=a},function(){c.getTotalForKey=0})},c.getCurrentKey(0),c.drawChart(c.chartSeries),c.maxSize=4,c.bigTotalItems=0,c.bigCurrentPage=1,c.itemPerPage=25,c.setPage=function(a){c.bigCurrentPage=a},c.pageChanged=function(){i?c.getCurrentKey(c.itemPerPage*(c.bigCurrentPage-1)):c.submitTimeRange(c.startDate,c.startTime,c.endDate,c.endTime,c.itemPerPage*(c.bigCurrentPage-1)),c.drawChart(c.chartSeries)},c.$watch("getTotalForKey",function(a){c.bigTotalItems=a});var j;c.$watch("timerCheck",function(a){var b=f("filter")(a,{val:!0});b===!0?(c.isUpdateChecked=!1,c.disableUpdate=!0,j=g(function(){c.getCurrentKey(0);var a=$("#chart1").highcharts(),b=a.series[0];c.listForChart=[],c.getTotal(-1,-1),h.getCurrentKey(c.currentKey,c.itemPerPage*(c.bigCurrentPage-1)).then(function(a){c.executionTimes=a,c.listForChart=[],a.forEach(function(a){c.listForChart.push(a.execution_time)}),b.setData(c.listForChart,!0,!0,!0)}),c.setPage(c.bigCurrentPage)},c.updateNumber)):c.stopTimer()},!0),c.stopTimer=function(){angular.isDefined(j)&&(g.cancel(j),j=void 0)},c.$on("$destroy",function(){c.stopTimer()})}]);var userApp=angular.module("userApp");userApp.controller("mainController",["$scope","$location","$http","API_URL",function(a,b,c,d){a.listOfKeys=[],c.get(d+"/keys").success(function(b,c){console.log("Info: got keys"),200===c?a.listOfKeys=b:console.log("Info: Keys empty")}).error(function(){a.listOfKeys="Error getting keys"}),c.get(d+"/total").success(function(b,c){200===c&&(a.totalRows=b)}).error(function(){a.totalRows="Error getting data"}),a.buttonClicked=function(a){b.path("/"+a+"/")}}]);